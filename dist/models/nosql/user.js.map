{"version":3,"sources":["../../../models/nosql/user.js"],"names":["mongodb","require","User","user","name","password","email","module","exports","prototype","save","callback","open","err","db","close","collection","mongdb","insert","get","console","log","findOne"],"mappings":";;AAAA;;;AAGA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;;AAEA,SAASC,IAAT,CAAcC,IAAd,EAAoB;AAChB,SAAKC,IAAL,GAAYD,KAAKC,IAAjB;AACA,SAAKC,QAAL,GAAgBF,KAAKE,QAArB;AACA,SAAKC,KAAL,GAAaH,KAAKG,KAAlB;AACH;;AAEDC,OAAOC,OAAP,GAAiBN,IAAjB;;AAEAA,KAAKO,SAAL,CAAeC,IAAf,GAAsB,UAAUC,QAAV,EAAoB;AACtC,QAAIR,OAAO;AACPC,cAAM,KAAKA,IADJ;AAEPC,kBAAU,KAAKA,QAFR;AAGPC,eAAO,KAAKA;AAHL,KAAX;AAKAN,YAAQY,IAAR,CAAa,UAASC,GAAT,EAAcC,EAAd,EAAiB;AAC1B,YAAGD,GAAH,EAAQ;AACJb,oBAAQe,KAAR;AACA,mBAAOJ,SAASE,GAAT,CAAP;AACH;AACDC,WAAGE,UAAH,CAAc,OAAd,EAAuB,UAASH,GAAT,EAAcG,UAAd,EAAyB;AAC5C,gBAAGH,GAAH,EAAO;AACHI,uBAAOF,KAAP;AACA,uBAAOJ,SAASE,GAAT,CAAP;AACH;AACDG,uBAAWE,MAAX,CAAkBf,IAAlB,EAAwB,EAAC,QAAQ,IAAT,EAAxB,EAAwC,UAASU,GAAT,EAAcV,IAAd,EAAmB;AACvDH,wBAAQe,KAAR;AACA,oBAAGF,GAAH,EAAQ,OAAOF,SAASE,GAAT,CAAP;AACRF,yBAASE,GAAT,EAAcV,IAAd;AACH,aAJD;AAKH,SAVD;AAWH,KAhBD;AAiBH,CAvBD;;AAyBAD,KAAKiB,GAAL,GAAW,UAAUf,IAAV,EAAgBO,QAAhB,EAA0B;AACjCS,YAAQC,GAAR,CAAY,mBAAZ;AACArB,YAAQY,IAAR,CAAa,UAASC,GAAT,EAAcC,EAAd,EAAiB;AAC1B,YAAGD,GAAH,EAAQ;AACJb,oBAAQe,KAAR;AACA,mBAAOJ,SAASE,GAAT,CAAP;AACH;AACDO,gBAAQC,GAAR,CAAY,mBAAZ;AACAP,WAAGE,UAAH,CAAc,OAAd,EAAuB,UAASH,GAAT,EAAcG,UAAd,EAAyB;AAC5C,gBAAGH,GAAH,EAAO;AACH,uBAAOF,SAASE,GAAT,CAAP;AACH;AACDG,uBAAWM,OAAX,CAAmB,EAAC,QAAQlB,IAAT,EAAnB,EAAmC,UAASS,GAAT,EAAcV,IAAd,EAAmB;AAClDH,wBAAQe,KAAR;AACA,oBAAGF,GAAH,EAAQ,OAAOF,SAASE,GAAT,CAAP;AACRF,yBAASE,GAAT,EAAcV,IAAd;AACH,aAJD;AAKH,SATD;AAUH,KAhBD;AAiBH,CAnBD","file":"user.js","sourcesContent":["/**\n * Created by yueqingji on 2017/7/12.\n */\nconst mongodb = require(\"./mongo\");\n\nfunction User(user) {\n    this.name = user.name;\n    this.password = user.password;\n    this.email = user.email\n}\n\nmodule.exports = User;\n\nUser.prototype.save = function (callback) {\n    let user = {\n        name: this.name,\n        password: this.password,\n        email: this.email\n    };\n    mongodb.open(function(err, db){\n        if(err) {\n            mongodb.close();\n            return callback(err);\n        }\n        db.collection(\"users\", function(err, collection){\n            if(err){\n                mongdb.close();\n                return callback(err)\n            }\n            collection.insert(user, {\"safe\": true}, function(err, user){\n                mongodb.close();\n                if(err) return callback(err);\n                callback(err, user)\n            })\n        })\n    })\n};\n\nUser.get = function (name, callback) {\n    console.log(\"正在打开mongo连接......\");\n    mongodb.open(function(err, db){\n        if(err) {\n            mongodb.close();\n            return callback(err);\n        }\n        console.log(\"正在打开collection...\");\n        db.collection(\"users\", function(err, collection){\n            if(err){\n                return callback(err)\n            }\n            collection.findOne({\"name\": name}, function(err, user){\n                mongodb.close();\n                if(err) return callback(err);\n                callback(err, user)\n            })\n        })\n    })\n};"]}